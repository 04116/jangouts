/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
"use strict";angular.module("janusHangouts",["ngAnimate","ngCookies","ngTouch","ngSanitize","blockUI","ui.router","ui.bootstrap","ngEmbed","cfp.hotkeys","janusHangouts.config","gridster","ngAudio","LocalStorageModule","angular-extended-notifications"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("signin",{url:"/sign_in?room",templateUrl:"app/signin/signin.html",controller:"SigninController",controllerAs:"vm",resolve:{StatesService:"StatesService",setRoomAndService:["StatesService","$state",function(e,t){return e.setRoomAndUser(t.toParams)}]}}).state("room",{url:"/rooms/:room?user",templateUrl:"app/room/room.html",controller:"RoomCtrl",resolve:{StatesService:"StatesService",setRoomAndService:["StatesService","$state",function(e,t){return e.setRoomAndUser(t.toParams)}]},onEnter:["UserService","RoomService",function(e,t){e.setSetting("lastRoom",t.getRoom().id)}]}),t.otherwise("/sign_in")}]).config(["blockUIConfig",function(e){e.templateUrl="app/room/consent-dialog.html",e.cssClass="block-ui block-ui-anim-fade consent-dialog",e.autoBlock=!1}]).config(["notificationsProvider",function(e){e.setDefaults({templatesDir:"app/templates/",faIcons:!0,closeOnRouteChange:"state"})}]).config(["localStorageServiceProvider",function(e){e.setPrefix("jh")}]).config(["$provide",function(e){e.decorator("$state",["$delegate","$rootScope",function(e,t){return t.$on("$stateChangeStart",function(t,n,o){e.toParams=o}),e}])}]).run(["$http","jhConfig",function(e,t){function n(e){return"string"==typeof e?e.replace("%{hostname}",window.location.host):e}var o=new XMLHttpRequest;if(o.open("GET","config.json",!1),o.send(null),200===o.status){var i=JSON.parse(o.responseText);angular.forEach(i,function(e,o){t[o]=n(e)})}else console.warn("No configuration found")}]).run(["EventsService",function(e){e.init()}]).run(["PluginsService",function(e){e.initPlugins()}]).run(["$rootScope","$state","RoomService",function(e,t,n){e.$on("$stateChangeStart",function(){n.leave()}),e.$on("$stateChangeError",function(){t.go("signin")})}]),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){function n(){function n(){t(function(){e.videoThumbnails=!e.videoThumbnails})}function o(){return e.videoThumbnails}var i=this;i.click=n,i.isChecked=o}return{restrict:"EA",templateUrl:function(e,t){var n="app/components/videochat/buttons/jh-thumbnails-mode-button";return t.textTemplate?n+"-with-text.html":n+".html"},scope:{},controllerAs:"vm",bindToController:!0,controller:n}}angular.module("janusHangouts").directive("jhThumbnailsModeButton",e),e.$inject=["jhConfig","$timeout"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){function e(){function e(){o.toggleFn()}function t(){o.resetFn()}function n(){return o.resizeModeOn}var o=this;o.toggle=e,o.reset=t,o.showsReset=n}return{restrict:"EA",templateUrl:"app/components/videochat/buttons/jh-resize-mode-button.html",scope:{toggleFn:"&",resetFn:"&",resizeModeOn:"="},controllerAs:"vm",bindToController:!0,controller:e}}angular.module("janusHangouts").directive("jhResizeModeButton",e)}(),/**
 * @file      callstats.provider.js
 * @author    Bimalkant Lauhny <lauhny.bimalk@gmail.com>
 * @copyright MIT License
 * @brief     A service that subscribes to eventsObservable
 *            and send stats to callstats.io
 */
function(){function e(){var e={AppID:null,AppSecret:null,debug:!1,callstats:null,log:function(){this.debug&&console.log.apply(this,arguments)},initializeCallstats:function(e){function t(e,t){o.log("Initialize return status: errCode= "+e+" errMsg= "+t)}function n(e){o.log("These are Initialize recieved stats: ",e);var t;for(t in e.streams){o.log("SSRC is: ",t);var n=e.streams[t];o.log("SSRC Type ",n.reportType),n.reportType===s.outbound?o.log("RTT is: ",n.rtt):n.reportType===s.inbound&&o.log("Inbound loss rate is: ",n.fractionLoss)}}var o=this;this.log("Received localUserID: ",e);var i=this.callstats.initialize(this.AppID,this.AppSecret,e,t,n,r);this.log("callstats.initialize response object",i);var s={inbound:"inbound",outbound:"outbound"},r={disableBeforeUnloadHandler:!1,applicationVersion:"0.4.6"}},sendPCObject:function(e,t,n){function o(e,t){i.log("Monitoring status: "+e+" msg: "+t)}var i=this;this.log("Send PC Object Parameters: ",e,t,n);var s=this.callstats.fabricUsage.multiplex;t&&n&&e?this.callstats.addNewFabric(e,t,s,n,o):this.log("ERROR: Faulty Parameters! ",e,t,n)},reportErrors:function(e,t,n,o){this.log("::: reporting error ::: ",n,o),this.callstats.reportError(e,t,this.callstats.webRTCFunctions[o],n)},sendEvents:function(e,t,n){this.log("::: Sending Event ::: ",n),this.callstats.sendFabricEvent(e,this.callstats.fabricEvent[n],t)},subscribeToEventsSubject:function(e){function t(e){n.log("Received Event: ",e);var t=e.type;switch(t){case"user":"joining"===e.data.status&&this.initializeCallstats(e.user.username);break;case"subscriber":break;case"stream":"local"===e.data.stream&&"main"===e.data["for"]?this.sendPCObject(e.data.peerconnection,"Janus",e.room.description):"remote"===e.data.stream&&"subscriber"===e.data["for"]&&this.sendPCObject(e.data.peerconnection,"Janus",e.room.description);break;case"screenshare":"started"===e.data.status?this.sendEvents(e.data.peerconnection,e.room.description,"screenShareStart"):"stopped"===e.data.status&&this.sendEvents(e.data.peerconnection,e.room.description,"screenShareStop");break;case"channel":var o=null;o="audio"===e.data.channel?"audio"+(e.data.status?"Unmute":"Mute"):"video"+(e.data.status?"Resume":"Pause"),this.sendEvents(e.data.peerconnection,e.room.description,o);break;case"pluginHandle":if("detached"===e.data.status&&["main","subscriber"].includes(e.data["for"])){var i=e.data.pluginHandle.webrtcStuff.pc;this.sendEvents(i,e.room.description,"fabricTerminated")}break;case"error":"createOffer"===e.data.status?this.reportErrors(e.data.peerconnection,e.room.description,e.data.error,"createOffer"):"createAnswer"===e.data.status&&this.reportErrors(e.data.peerconnection,e.room.description,e.data.error,"createAnswer");break;default:n.log("Unknown type of event: ",e)}}var n=this;e.subscribe(t.bind(this))}};return{$get:function(){return e},$set:function(t,n){e[t]=n}}}angular.module("janusHangouts").provider("CallstatsProvider",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o,i){function s(){var o=e[0],i=t.defer(),s=o.createElement("script");return s.src="https://api.callstats.io/static/callstats.min.js",o.body.appendChild(s),s.onload=s.onreadystatechange=function(e){(!s.readyState||["complete","loaded"].includes(s.readyState))&&n(function(){i.resolve(e)})},s.onerror=function(e){n(function(){i.reject(e)})},i.promise}function r(){var e=new XMLHttpRequest;if(e.open("GET","config.callstats.json",!1),e.send(null),200===e.status){var t=JSON.parse(e.responseText);angular.forEach(t,function(e,t){i[t]=e})}else console.warn("No Callstats configuration found!")}this.init=function(){s().then(function(){r(),i.callstats=new window.callstats,(null===i.callstats||void 0===i.callstats)&&console.error("Something went wrong loading callstats.min.js!"),i.subscribeToEventsSubject(o.getEventsSubject())})["catch"](function(){console.error("Could not load callstats.min.js!")})}}angular.module("janusHangouts").service("CallstatsPlugin",e),e.$inject=["$document","$q","$timeout","EventsService","CallstatsProvider"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(){function t(){e.toggleChannel("video",i.feed)}function n(){return i.feed&&i.feed.isPublisher&&!i.feed.getVideoEnabled()}function o(){return i.feed&&i.feed.isPublisher&&i.feed.getVideoEnabled()}var i=this;i.toggle=t,i.showsEnable=n,i.showsDisable=o}return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-video-button.html",scope:{feed:"="},controllerAs:"vm",bindToController:!0,controller:t}}angular.module("janusHangouts").directive("jhVideoButton",e),e.$inject=["RoomService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(){function t(){e.unPublishFeed(o.feed.id)}function n(){return o.feed.isPublisher&&o.feed.isLocalScreen}var o=this;o.click=t,o.isVisible=n}return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-unpublish-button.html",scope:{feed:"="},controllerAs:"vm",bindToController:!0,controller:t}}angular.module("janusHangouts").directive("jhUnpublishButton",e),e.$inject=["RoomService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){function e(){function e(){o.clickFn()}function t(){return!o.sticky&&!o.feed.isIgnored}function n(){return o.sticky}var o=this;o.click=e,o.showsEnable=t,o.showsDisable=n}return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-sticky-button.html",scope:{feed:"=",clickFn:"&",highlighted:"=",sticky:"="},controllerAs:"vm",bindToController:!0,controller:e}}angular.module("janusHangouts").directive("jhStickyButton",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o){function i(){function i(){var e=o.getSetting("lastHotkey");e&&(g.hotkeyActive=!0,l(e))}function s(e){h||(e.currentTarget.blur(),g.hotkeyActive?(null!==g.hotkey?l(null):window.Mousetrap.stopRecord(),g.hotkeyActive=!1):(g.hotkeyActive=!0,r()))}function r(){g.toggleText="Press hotkey";var e=function(e){g.toggleText="",void 0!==e&&null!==e&&void 0!==e[0]&&e[0].length>0?e[0].indexOf("+")>-1&&1!==e[0].length||"\\"===e[0]?a("Sorry, key combinations are not supported!"):l(e[0]):g.hotkeyActive=!1};window.Mousetrap.record({recordSequence:!1},function(t){e(t)})}function a(e){g.toggleText=e,h=!0;var t=function(){g.toggleText="",g.hotkeyActive=!1,h=!1};n(t,3e3)}function l(n){if(null!==g.hotkey&&(t.del(g.hotkey,"keydown"),t.del(g.hotkey,"keyup"),g.hotkey=null,g.showHotkey=!1,g.titleText=u),null!==n){var i=function(t){t.preventDefault(),e.pushToTalk(t.type)};t.add({combo:n,description:"Push-to-talk",callback:i,action:"keydown"}),t.add({combo:n,description:"Push-to-talk",callback:i,action:"keyup"}),g.hotkey=n,g.showHotkey=!0,g.titleText=d}o.setSetting("lastHotkey",n)}function c(){return g.toggleText&&""!==g.toggleText}var u="Set Push-to-talk hotkey",d="Disable Push-to-talk",h=!1,g=this;g.hotkeyActive=!1,g.showHotkey=!1,g.hotkey=null,g.titleText=u,g.click=s,g.isRecording=c,i()}return{restrict:"E",templateUrl:"app/components/feed/buttons/jh-pushtotalk-button.html",controllerAs:"vm",controller:i,scope:{}}}angular.module("janusHangouts").directive("jhPushtotalkButton",e),e.$inject=["RoomService","hotkeys","$timeout","UserService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(){function t(){return!s.feed.isPublisher&&!s.feed.isIgnored}function n(){return s.feed.isIgnored}function o(){e.ignoreFeed(s.feed.id)}function i(){e.stopIgnoringFeed(s.feed.id)}var s=this;s.ignore=o,s.stopIgnoring=i,s.showsIgnore=t,s.showsStopIgnoring=n}return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-ignore-button.html",scope:{feed:"="},controllerAs:"vm",bindToController:!0,controller:t}}angular.module("janusHangouts").directive("jhIgnoreButton",e),e.$inject=["RoomService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){function e(){function e(){i.feed.setEnabledTrack("audio",!i.feed.isTrackEnabled("audio"))}function t(){return o()&&i.feed.isTrackEnabled("audio")}function n(){return o()&&!i.feed.isTrackEnabled("audio")}function o(){return!i.feed.isPublisher&&!i.feed.isIgnored&&i.feed.hasTrack("audio")}var i=this;i.toggle=e,i.showsIgnore=t,i.showsStopIgnoring=n}return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-ignore-audio-button.html",scope:{feed:"="},controllerAs:"vm",bindToController:!0,controller:e}}angular.module("janusHangouts").directive("jhIgnoreAudioButton",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){function n(){function n(){var n=a.feed;e.toggleChannel("audio",n),!n.isPublisher||n.isLocalScreen||n.getAudioEnabled()||t.dismissLastNotification()}function o(){var e=a.feed;return e&&e.isPublisher&&!e.isLocalScreen&&!e.getAudioEnabled()}function i(){var e=a.feed;return e&&!e.isIgnored&&e.getAudioEnabled()}function s(){var e=a.feed;return e&&!e.isPublisher&&!e.isIgnored&&!e.getAudioEnabled()}function r(){return a.withMonitor&&a.feed&&a.feed.getSpeaking()}var a=this;a.toggle=n,a.showsEnable=o,a.showsDisable=i,a.showsAudioOff=s,a.isSpeaking=r}return{restrict:"EA",templateUrl:"app/components/feed/buttons/jh-audio-button.html",scope:{feed:"=",withMonitor:"="},controllerAs:"vm",bindToController:!0,controller:n}}angular.module("janusHangouts").directive("jhAudioButton",e),e.$inject=["RoomService","MuteNotifier"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o,i,s,r){function a(e,t){e.$on("gridster-resized",function(){e.vm.adjustAllSizes()}),r(function(){e.vm.adjustAllSizes()},600),e.$watch("vm.gridsterItems",function(){e.vm.gridsterIgnoreNextChange?e.vm.gridsterIgnoreNextChange=!1:e.vm.gridsterDirtyBit=!0,r(function(){e.vm.adjustAllSizes()},600)},!0),e.$watch(function(){return $("#thumbnails .thumb",t).size()},function(){e.vm.adjustFeedsSizes()})}function l(){function e(){var e=$(window).width()-25,t=$(window).height()-33-20-5,n=e/k,o=Math.floor(t/n);6>o&&(o=6);var i,s,r,a;return 10>o?(i=Math.ceil(o/2),s=Math.floor(o/2),r=i,a=8):(i=o,s=o-6,r=6,a=0),[{size:[8,6],position:[0,0],content:"Speaker"},{size:[8,i],position:[0,8],content:"Participants"},{size:[8,s],position:[r,a],content:"Chat"}]}function r(){j.gridsterDirtyBit&&(o.setSetting("gridsterItems",j.gridsterItems),i.info("Your layout has been successfully saved")),j.gridsterDirtyBit=!1}function a(){return!j.gridsterDirtyBit&&void 0===o.getSetting("gridsterItems")}function l(){return n.allFeeds()}function c(){return n.findMain()}function u(){if(null!==j.highlight.byUser)j.highlight.current=j.highlight.byUser;else{var e=j.highlight.current;if(e&&!e.isConnected()&&(e=null),!(e&&e.getSpeaking()&&e.getVideoEnabled())){var t=n.speakingFeed();j.highlight.current=t&&t.getVideoEnabled()?t:e||n.findMain()}}return j.highlight.current}function d(){var e=j.highlightedFeed();return e?e.isPublisher&&!e.isLocalScreen:!1}function h(e){j.highlight.byUser=j.highlight.byUser!==e?e:null}function g(e){return e===j.highlight.current}function f(e){return e===j.highlight.byUser}function m(){return t.allEntries()}function p(e){var t,n=e.innerWidth(),o=e.innerHeight();t=$("#main-video video",e),t.length&&t.css({height:o+"px",width:n+"px"}),t=$("#jh-chat-messages",e),t.length&&t.css({height:o-40+"px"}),t=$("#thumbnails",e),t.length&&(t.css({height:o+"px",width:n+"px"}),S())}function v(){$(".gridster-item").each(function(e,t){p($(t))})}function b(){s.toggleCheatSheet()}function y(){j.windowResizeModeOn=!j.windowResizeModeOn,j.gridsterOpts.resizable.enabled=j.windowResizeModeOn,j.gridsterOpts.draggable.enabled=j.windowResizeModeOn,j.windowResizeModeOn||r()}function w(){a()||(j.gridsterIgnoreNextChange=!0,j.gridsterDirtyBit=!1,j.gridsterItems=e(),o.removeSetting("gridsterItems"),i.info("Your layout preferences have been deleted"))}function S(){var e,t,n,o,i=$("#thumbnails"),s=i.innerWidth(),r=i.innerHeight(),a=4,l=33,c=$(".thumb",i).size(),u=!0;for(e=128;e>=64;e-=4)if(n=.75*e+l,t=Math.floor(s/(e+a)),o=Math.ceil(c/t),r>=o*n){u=!1;break}64>e&&(e=64),$(".face",i).css({height:.75*e+"px",width:e+"px"}),i.css(u?{"overflow-y":"scroll"}:{"overflow-y":"hidden"})}var j=this,k=16;j.gridsterDirtyBit=!1,j.gridsterIgnoreNextChange=!0,j.gridsterItems=o.getSetting("gridsterItems")||e(),j.gridsterOpts={columns:k,resizable:{enabled:!1},draggable:{enabled:!1}},j.highlight={byUser:null,current:null},j.feeds=l,j.mainFeed=c,j.highlightedFeed=u,j.mirrored=d,j.toggleHighlightedFeed=h,j.isHighlighted=g,j.isHighlightedByUser=f,j.logEntries=m,j.adjustAllSizes=v,j.adjustFeedsSizes=S,j.showHotkeys=b,j.windowResizeModeOn=!1,j.toggleWindowResizeMode=y,j.setDefaultLayout=w}return{restrict:"EA",templateUrl:"app/components/videochat/jh-video-chat.html",scope:{},controllerAs:"vm",bindToController:!0,link:a,controller:l}}angular.module("janusHangouts").directive("jhVideoChat",e),e.$inject=["$window","LogService","FeedsService","UserService","Notifier","hotkeys","$timeout"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){var n="userSettings";this.user=null,this.settings=e.get(n)||{},this.getUser=function(){return this.user},this.signin=function(e){this.setSetting("lastUsername",e),this.user={username:e},t.setUser(this.user)},this.getSettings=function(){return this.settings},this.getSetting=function(e){return this.settings[e]},this.removeSetting=function(e){delete this.settings[e],this.storeSettings()},this.clearSettings=function(){return this.settings={},e.clearAll(n)},this.setSetting=function(e,t){this.settings[e]=t,this.storeSettings()},this.storeSettings=function(){e.set(n,this.settings)},this.enteredPin=null,this.getPin=function(){return this.enteredPin},this.setPin=function(e){this.enteredPin=e}}angular.module("janusHangouts").service("UserService",e),e.$inject=["localStorageService","EventsService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n){function o(e,t){setTimeout(function(){$("#inputUsername",t).focus()},100),e.vm.adjustHeight(),$(window).on("resize",function(){e.vm.adjustHeight()})}function i(){function o(){a.room&&a.username&&(n.setPin(a.enteredPin),e.go("room",{room:a.room.id,user:a.username}))}function i(){return a.listRooms===!0}function s(){return a.listRooms===!1}function r(){var e=$(window).outerHeight()-$("footer").outerHeight();$("#signin").css({height:e+"px"})}var a=this;a.signin=o,a.adjustHeight=r,a.showRoomsList=i,a.showRoom=s,a.username=null,a.room=null,a.rooms=[],a.listRooms=null,a.enteredPin=null,t.getRooms().then(function(e){if(a.room=t.getRoom(),a.rooms=e,a.listRooms=null===a.room,null!==n.getUser()&&(a.username=n.getUser().username),null===a.room){var o=n.getSetting("lastRoom");a.room=_.find(e,function(e){return e.id===o})}})}return{restrict:"EA",templateUrl:"app/components/user/jh-signin-form.html",scope:!0,link:o,controllerAs:"vm",bindToController:!0,controller:i}}angular.module("janusHangouts").directive("jhSigninForm",e),e.$inject=["$state","RoomService","UserService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){function n(t){var n=this;e(function(){n.inProgress=t})}function o(){return this.inProgress}function i(){t.open({animation:!0,templateUrl:"app/components/screen-share/screen-share-help.html",controller:"ScreenShareHelpCtrl",controllerAs:"vm"})}this.inProgress=!1,this.setInProgress=n,this.getInProgress=o,this.showHelp=i}angular.module("janusHangouts").service("ScreenShareService",e),e.$inject=["$timeout","$uibModal"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(){e.dismiss("cancel")}function n(){return window.location.hostname}var o=this;o.close=t,o.hostname=n}angular.module("janusHangouts").controller("ScreenShareHelpCtrl",e),e.$inject=["$uibModalInstance"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n){function o(){function o(){r.enabled()&&t.publishScreen(r.source)}function i(){return n.usingSSL()&&!e.getInProgress()}function s(){return r.enabled()?r.label:e.getInProgress()?"Wait while the screen is shared":"Screen sharing disabled (no SSL?)"}var r=this;r.click=o,r.enabled=i,r.title=s}return{restrict:"EA",templateUrl:"app/components/screen-share/jh-screen-share-sub-button.html",scope:{source:"=",icon:"=",label:"="},controllerAs:"vm",bindToController:!0,controller:o}}angular.module("janusHangouts").directive("jhScreenShareSubButton",e),e.$inject=["ScreenShareService","RoomService","RequestService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){function n(){function n(){return o.usingSSL()||o.httpsUrl()}var o=this;o.showHelp=function(){e.showHelp()},o.usingSSL=function(){return t.usingSSL()},o.httpsUrl=function(){return t.httpsUrl()},o.visible=n}return{restrict:"EA",templateUrl:"app/components/screen-share/jh-screen-share-hint.html",scope:!0,controllerAs:"vm",bindToController:!0,controller:n}}angular.module("janusHangouts").directive("jhScreenShareHint",e),e.$inject=["ScreenShareService","RequestService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){function e(){}var t=window.navigator.mozGetUserMedia?"-moz":"";return{restrict:"EA",templateUrl:"app/components/screen-share/jh-screen-share-button"+t+".html",scope:!0,controllerAs:"vm",bindToController:!0,controller:e}}angular.module("janusHangouts").directive("jhScreenShareButton",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n){this.setRoomAndUser=function(o){var i=e.defer(),s=o.user||n.getSetting("lastUsername");void 0!==s&&n.signin(s);var r=parseInt(o.room);return Number.isNaN(r)?(t.setRoom(null),i.resolve()):t.getRooms().then(function(e){var n=_.find(e,function(e){return e.id===r});t.setRoom(n||null),i.resolve()}),i.promise}}angular.module("janusHangouts").service("StatesService",e),e.$inject=["$q","RoomService","UserService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(){return"https:"===window.location.protocol}function n(){return e.httpsAvailable?e.httpsUrl?e.httpsUrl:"https://"+window.location.hostname+window.location.pathname:null}this.usingSSL=t,this.httpsUrl=n}angular.module("janusHangouts").service("RequestService",e),e.$inject=["jhConfig"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){return function(e){e=e||{},_.assign(this,e),this.id=this.room,this.label=this.description+" ("+this.num_participants+"/"+this.max_publishers+" users)"}}angular.module("janusHangouts").factory("Room",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o,i,s,r,a,l,c,u,d,h){function g(){var e,t;return u.usingSSL()?(e="wss:",t="8989"):(e="ws:",t="8188"),[e+"//"+window.location.hostname+":"+t+"/janus/",window.location.protocol+"//"+window.location.hostname+"/janus/"]}function f(){var t=e.defer();return null===R.janus?(Janus.init({debug:l.janusDebug}),R.janus=new Janus({server:R.server,success:function(){t.resolve()},error:function(e){var n="Janus error: "+e;n+="\nDo you want to reload in order to retry?",t.reject(),window.confirm(n)&&window.location.reload()},destroyed:function(){console.log("Janus object destroyed")}})):t.resolve(),t.promise}function m(e){var n=t,i=null;h.setRoom(R.room),h.emitEvent({type:"user",data:{status:"joining"}}),R.janus.attach({plugin:"janus.plugin.videoroom",success:function(t){h.emitEvent({type:"pluginHandle",data:{status:"attached","for":"main",pluginHandle:t}}),i=new s(t,R.room.id,"main"),i.register(e,d.getPin())},error:function(e){console.error("Error attaching plugin... "+e)},consentDialog:function(e){console.log("Consent dialog should be "+(e?"on":"off")+" now"),n.$broadcast("consentDialog.changed",e),e||A&&n.$broadcast("muted.Join")},ondataopen:function(){console.log("The publisher DataChannel is available"),i.onDataOpen(),x()},onlocalstream:function(e){console.log(" ::: Got a local stream :::"),h.emitEvent({type:"stream",data:{stream:"local","for":"main",peerconnection:i.pluginHandle.webrtcStuff.pc}});var t=o.findMain();t.setStream(e)},oncleanup:function(){console.log(" ::: Got a cleanup notification: we are unpublished now :::")},onmessage:function(t,o){var s=t.videoroom;if(console.log("Event: "+s),"joined"===s)console.log("Successfully joined room "+t.room),h.emitEvent({type:"user",data:{status:"joined"}}),a.enterRoom(t.id,e,i),void 0!==l.joinUnmutedLimit&&null!==l.joinUnmutedLimit&&(A=t.publishers instanceof Array&&t.publishers.length>=l.joinUnmutedLimit),i.publish({muted:A,error:function(){i.publish({noCamera:!0,muted:A})}}),t.publishers instanceof Array&&t.publishers.length>0&&R.subscribeToFeeds(t.publishers,R.room.id);else if("destroyed"===s)console.log("The room has been destroyed!"),n.$broadcast("room.destroy");else if("event"===s)if(t.publishers instanceof Array&&t.publishers.length>0)R.subscribeToFeeds(t.publishers,R.room.id);else if(void 0!==t.leaving&&null!==t.leaving){var r=t.leaving;a.destroyFeed(r)}else if(void 0!==t.unpublished&&null!==t.unpublished){var c=t.unpublished;a.unpublishFeed(c)}else t.configured?i.confirmConfig():void 0!==t.error&&null!==t.error&&(console.log("Error message from server"+t.error),n.$broadcast("room.error",t.error));void 0!==o&&null!==o&&i.handleRemoteJsep(o)}})}function p(){var t=e.defer();return R.janus.attach({plugin:"janus.plugin.videoroom",success:function(e){console.log("getAvailableRooms plugin attached ("+e.getPlugin()+", id="+e.getId()+")");var n={request:"list"};e.send({message:n,success:function(n){if(e.detach(),"success"===n.videoroom){var o=_.map(n.list,function(e){return new i(e)});o=_.sortBy(o,"label"),t.resolve(o)}else t.reject()}})}}),t.promise}function v(t){var n=e.defer();return f().then(function(){m(t),n.resolve()}),n.promise}function b(){a.leaveRoom()}function y(e){this.room=e}function w(){return this.room}function S(){var t=e.defer();return null===this.rooms?f().then(function(){p().then(function(e){R.rooms=e,t.resolve(e)})}):t.resolve(this.rooms),t.promise}function j(e){console.log("Got a list of available publishers/feeds:"),console.log(e);for(var t=0;t<e.length;t++){var n=e[t].id,i=e[t].display;console.log("  >> ["+n+"] "+i);var s=o.find(n);(null===s||s.waitingForConnection())&&this.subscribeToFeed(n,i)}}function k(e,t){var i=o.find(e),c=null;i&&(t=i.display),h.emitEvent({type:"subscriber",data:{status:"subscribing",to:t}}),this.janus.attach({plugin:"janus.plugin.videoroom",success:function(t){h.emitEvent({type:"pluginHandle",data:{status:"attached","for":"subscriber",pluginHandle:t}}),c=new s(t,R.room.id,"subscriber"),c.listen(e,d.getPin())},error:function(e){console.error("  -- Error attaching plugin... "+e)},onmessage:function(o,s){console.log(" ::: Got a message (listener) :::"),console.log(JSON.stringify(o));var r=o.videoroom;console.log("Event: "+r),"attached"===r?(h.emitEvent({type:"subscriber",data:{status:"susbscribed",to:t}}),n(function(){i?a.stopIgnoringFeed(e,c):a.remoteJoin(e,t,c),console.log("Successfully attached to feed "+e+" ("+t+") in room "+o.room)})):o.configured?c.confirmConfig():o.started?c.setConfig({values:{audio:!0,data:!0,video:l.videoThumbnails}}):console.log("What has just happened?!"),void 0!==s&&null!==s&&c.subscribe(s)},onremotestream:function(t){h.emitEvent({type:"stream",data:{stream:"remote","for":"subscriber",peerconnection:c.pluginHandle.webrtcStuff.pc}}),o.waitFor(e).then(function(e){e.setStream(t)},function(e){console.error(e)})},ondataopen:function(){console.log("The subscriber DataChannel is available"),c.onDataOpen(),x()},ondata:function(t){console.log(" ::: Got info in the data channel (subscriber) :::"),r.receiveMessage(t,e)},oncleanup:function(){console.log(" ::: Got a cleanup notification (remote feed "+e+") :::")}})}function C(e){var t,n,i=o.findMain().display;h.emitEvent({type:"screenshare",data:{status:"starting"}}),this.janus.attach({plugin:"janus.plugin.videoroom",success:function(n){h.emitEvent({type:"pluginHandle",data:{status:"attached","for":"screen",pluginHandle:n}}),t=new s(n,R.room.id,e),t.register(i,d.getPin()),c.setInProgress(!0)},error:function(e){console.error("  -- Error attaching screen plugin... "+e)},onlocalstream:function(e){console.log(" ::: Got the screen stream :::");var i=o.find(n);i.setStream(e),h.emitEvent({type:"stream",data:{stream:"local","for":"screen",peerconnection:t.pluginHandle.webrtcStuff.pc}}),h.emitEvent({type:"screenshare",data:{status:"started",peerconnection:t.pluginHandle.webrtcStuff.pc}}),e.onended=function(){h.emitEvent({type:"screenshare",data:{status:"stopped",peerconnection:t.pluginHandle.webrtcStuff.pc}}),E(n),c.setInProgress(!1)}},onmessage:function(e,o){console.log(" ::: Got a message (screen) :::"),console.log(e);var s=e.videoroom;"joined"===s?(n=e.id,a.publishScreen(n,i,t),t.publish({success:function(){c.setInProgress(!1)},error:function(e){console.log(e),E(n),c.setInProgress(!1),c.showHelp()}})):e.configured?t.confirmConfig():console.log("Unexpected event for screen"),void 0!==o&&null!==o&&t.handleRemoteJsep(o)}})}function E(e){a.destroyFeed(e)}function $(e){a.ignoreFeed(e)}function T(e){this.subscribeToFeed(e)}function H(e,t){a.toggleChannel(e,t)}function P(e){var t=function(){a.setMedia("audio",!1),U=!1};I&&n.cancel(I),I=n(t,1e3),"keydown"!==e||U?"keyup"===e&&(a.setMedia("audio",!1),U=!1,n.cancel(I)):(a.setMedia("audio",!0),U=!0)}function x(){o.publisherFeeds().forEach(function(e){r.sendStatus(e,{exclude:"picture"}),n(function(){r.sendStatus(e)},4e3)})}this.enter=v,this.leave=b,this.setRoom=y,this.getRoom=w,this.getRooms=S,this.publishScreen=C,this.unPublishFeed=E,this.ignoreFeed=$,this.stopIgnoringFeed=T,this.subscribeToFeeds=j,this.subscribeToFeed=k,this.toggleChannel=H,this.pushToTalk=P,this.room=null,this.rooms=null,this.janus=null;var R=this,A=!1,U=!1,I=null;this.server=l.janusServer?l.janusServer:g(),l.janusServerSSL&&u.usingSSL()&&(this.server=l.janusServerSSL)}angular.module("janusHangouts").service("RoomService",e),e.$inject=["$q","$rootScope","$timeout","FeedsService","Room","FeedConnection","DataChannelService","ActionService","jhConfig","ScreenShareService","RequestService","UserService","EventsService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(t){var n=this;e(function(){n.entries.push(t)})}function n(){return this.entries}this.entries=[],this.add=t,this.allEntries=n}angular.module("janusHangouts").service("LogService",e),e.$inject=["$timeout"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){return function(t,n){this.type=t,this.timestamp=new Date,this.content=n||{},this.text=function(){return this[this.type+"Text"]()},this.muteRequestText=function(){var e;return e=this.content.source.isPublisher?"You have muted ":this.content.source.display+" has muted ",e+=this.content.target.isPublisher?"you":this.content.target.display},this.chatMsgText=function(){return e(this.content.text).trim()},this.publishScreenText=function(){return"Screen sharing started"},this.destroyFeedText=function(){return this.content.feed.isLocalScreen?"Screen sharing stopped":this.content.feed.display+" has left the room"},this.newRemoteFeedText=function(){return this.content.feed.display+" has joined the room"},this.ignoreFeedText=function(){return"You are ignoring "+this.content.feed.display+" now"},this.stopIgnoringFeedText=function(){return"You are not longer ignoring "+this.content.feed.display},this.hasText=function(){return""!==this.text()}}}angular.module("janusHangouts").factory("LogEntry",["$sanitize",e])}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(){function t(){var t=e.getRoom();return t?t.description:""}var n=this;n.name=t}return{restrict:"EA",templateUrl:"app/components/room/jh-room-info.html",scope:{},controllerAs:"vm",bindToController:!0,controller:t}}angular.module("janusHangouts").directive("jhRoomInfo",e),e.$inject=["RoomService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){function n(){var n=this;n.leave=function(){t.setRoom(null),e.go("signin")}}return{restrict:"EA",templateUrl:"app/components/room/jh-leave-button.html",scope:!0,controller:n,controllerAs:"vm"}}angular.module("janusHangouts").directive("jhLeaveButton",e),e.$inject=["$state","RoomService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o){function i(i,s){var r,a,l=JSON.parse(i),c=l.type,u=l.content;"chatMsg"===c?(a=new t("chatMsg",{feed:e.find(s),text:u}),a.hasText()&&n.add(a)):"muteRequest"===c?(r=e.find(u.target),r.isPublisher&&r.setEnabledChannel("audio",!1,{after:function(){o.$broadcast("muted.byRequest")}}),a=new t("muteRequest",{source:e.find(s),target:r}),n.add(a)):"statusUpdate"===c?(r=e.find(u.source),r&&!r.isPublisher&&r.setStatus(u.status)):console.log("Unknown data type: "+c)}function s(e){var t={target:e.id};l("muteRequest",t)}function r(e,t){var n={source:e.id,status:e.getStatus(t)};l("statusUpdate",n)}function a(e){l("chatMsg",e)}function l(t,n){var o=JSON.stringify({type:t,content:n}),i=e.findMain();if(null!==i){if(!i.isDataOpen())return void console.log("Data channel not open yet. Skipping");var s=i.connection;s.sendData({text:o,error:function(e){alert(e)},success:function(){console.log("Data sent: "+t)}})}}this.sendStatus=r,this.sendMuteRequest=s,this.sendChatMessage=a,this.receiveMessage=i}angular.module("janusHangouts").service("DataChannelService",e),e.$inject=["FeedsService","LogEntry","LogService","$rootScope"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o,i,s,r){function a(e,o,i){var s=new t({display:o,connection:i,id:e,isPublisher:!0});n.add(s,{main:!0})}function l(){var e=this;_.forEach(n.allFeeds(),function(t){e.destroyFeed(t.id)})}function c(e,s,r){var a=new t({display:s,connection:r,id:e,isPublisher:!0,isLocalScreen:!0});n.add(a);var l=new o("publishScreen");i.add(l)}function u(e,s,r){var a=new t({display:s,connection:r,id:e,isPublisher:!1});n.add(a);var l=new o("newRemoteFeed",{feed:a});i.add(l)}function d(t){var s=n.find(t);if(null!==s){e(function(){s.disconnect(),n.destroy(t)});var r=new o("destroyFeed",{feed:s});i.add(r)}}function h(t){var o=n.find(t);null!==o&&e(function(){o.disconnect(),n.destroy(t)})}function g(e){var t=n.find(e);if(null!==t){t.ignore();var s=new o("ignoreFeed",{feed:t});i.add(s)}}function f(e,t){var s=n.find(e);if(null!==s){s.stopIgnoring(t);var r=new o("stopIgnoringFeed",{feed:s});i.add(r)}}function m(e){var t=new o("chatMsg",{feed:n.findMain(),text:e});t.hasText()&&(i.add(t),s.sendChatMessage(e))}function p(e,t){if(t||(t=n.findMain())){if(!t.isPublisher){var s=new o("muteRequest",{source:n.findMain(),target:t});i.add(s)}if(t.isEnabled(e)){var a=null;"audio"===e&&t.isPublisher&&(a=function(){r.$broadcast("muted.byUser")}),t.setEnabledChannel(e,!1,{after:a})}else t.setEnabledChannel(e,!0)}}function v(e,t){var o=n.findMain();o&&o.setEnabledChannel(e,t)}this.enterRoom=a,this.leaveRoom=l,this.remoteJoin=u,this.destroyFeed=d,this.unpublishFeed=h,this.ignoreFeed=g,this.stopIgnoringFeed=f,this.writeChatMessage=m,this.publishScreen=c,this.toggleChannel=p,this.setMedia=v}angular.module("janusHangouts").service("ActionService",e),e.$inject=["$timeout","Feed","FeedsService","LogEntry","LogService","DataChannelService","$rootScope"]}(),/*
 * Copyright (C) 2017 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){this.initPlugins=function(){e.enabledPlugins&&e.enabledPlugins.includes("callstats")&&(console.info("Initializing CallstatsPlugin"),t.init())}}angular.module("janusHangouts").service("PluginsService",e),e.$inject=["jhConfig","CallstatsPlugin"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(t){e.info("Information",t,{duration:5e3,attachTo:$("#videochat-body")})}this.info=t}angular.module("janusHangouts").service("Notifier",e),e.$inject=["notifications"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o,i){function s(){c("You have been muted by another user.")}function r(){c("Trying to say something? You are muted.")}function a(){var e="You are muted because ";e+=0===i.joinUnmutedLimit?"everyone who enters a room is muted by default.":1===i.joinUnmutedLimit?"there is already one participant in the room.":"there are already "+i.joinUnmutedLimit+" participants in the room.",c(e)}function l(){null!==h&&h.close()}function c(e){if(!(e in d||g)){var n=t.info("Muted",e,{show:function(){g=!0,u.play()},close:function(){g=!1,h=null},duration:2e4,attachTo:$("#videochat-body"),actions:[{label:"Unmute",className:"btn btn-default",fn:function(){o.toggleChannel("audio"),n.close()}},{label:"Don't show again",className:"btn btn-default",fn:function(){d[e]=!0,n.close()}}]});h=n}}this.speaking=r,this.muted=s,this.joinedMuted=a,this.dismissLastNotification=l;var u=n.load("assets/sounds/bell.ogg"),d={},h=null,g=!1}angular.module("janusHangouts").service("MuteNotifier",e),e.$inject=["$animate","notifications","ngAudio","ActionService","jhConfig"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){return{restrict:"EA",templateUrl:"app/components/footer/jh-footer.html",scope:!0}}angular.module("janusHangouts").directive("jhFooter",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){return function(t,n){function o(){var e,t=i();t&&!h?(e=_.sum(_.slice(g,g.length-3)),e>=2&&(h=!0,n.start&&n.start())):!t&&h&&(e=_.sum(g),0===e&&(h=!1,n.stop&&n.stop())),g.shift(),g.push(0+t)}function i(){c.getFloatFrequencyData(u);for(var e=4,t=u.length;t>e;e++)if(u[e]>r&&u[e]<0)return!0;return!1}n=n||{};var s=n.interval||65,r=n.threshold||-50,a=window.AudioContext||window.webkitAudioContext,l=new a,c=l.createAnalyser();c.fftSize=512,c.smoothingTimeConstant=.1;var u=new window.Float32Array(c.fftSize),d=l.createMediaStreamSource(t);d.connect(c);var h=!1,g=_.fill(new Array(10),0),f=e(function(){"suspended"===l.state?l.resume():o()},s);this.destroy=function(){e.cancel(f)},this.isSpeaking=function(){return h}}}angular.module("janusHangouts").factory("SpeakObserver",e),e.$inject=["$interval"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){function e(e,t){e.$watch("vm.feed.getStream()",function(e){if(void 0!==e&&null!==e){var n=$("video",t)[0];n.muted=!0,Janus.attachMediaStream(n,e)}})}function t(){}return{restrict:"EA",templateUrl:"app/components/feed/jh-main-feed.html",scope:{feed:"=",message:"@"},controllerAs:"vm",bindToController:!0,controller:t,link:e}}angular.module("janusHangouts").directive("jhMainFeed",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){function n(){function n(){var t=e.findMain(),n=null!==t?t.display:"";return n}function o(e){13===e.keyCode?(l.updateName(),l.leaveEditingMode()):27===e.keyCode&&l.leaveEditingMode()}function i(){l.editing=!1,l.newName=null}function s(){l.editing=!0}function r(){return l.editing}function a(){l.newName&&(e.findMain().updateDisplay(l.newName),t.go("room",{user:l.newName},{notify:!1})),this.leaveEditingMode()}var l=this;l.name=n,l.makeNameEditable=s,l.leaveEditingMode=i,l.editing=!1,l.isEditing=r,l.updateName=a,l.newName=null,l.keyDetect=o}return{restrict:"EA",templateUrl:"app/components/feed/jh-main-feed-info.html",scope:{},controllerAs:"vm",bindToController:!0,controller:n}}angular.module("janusHangouts").directive("jhMainFeedInfo",e),e.$inject=["FeedsService","$state"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o){function i(e,i){function s(e){return Date.now()+1e3*e}function r(){return s(0)}e.$watch("vm.feed.getStream()",function(t){if(void 0!==t&&null!==t){var n=$("video",i)[0];n.muted=e.vm.feed.isPublisher,Janus.attachMediaStream(n,t)}});var a=e.vm,l=a.feed;if(l.isPublisher){if(a.initPics(i),a.takePic(),t(a.takePic,2e4),!l.isLocalScreen){var c=r();e.$on("muted.byRequest",function(){c=s(3),o.muted()}),e.$on("muted.byUser",function(){c=r()}),e.$on("muted.Join",function(){c=r(),o.joinedMuted()}),e.$watch("vm.feed.isVoiceDetected()",function(e){e&&l.getAudioEnabled()===!1&&r()>c&&(o.speaking(),c=s(60))})}}else l.setVideoSubscription(n.videoThumbnails||a.highlighted),e.$watch(function(){return n.videoThumbnails||a.highlighted||!a.feed.isSilent()},function(e){l.setVideoSubscription(e)})}function s(){function e(){return o.highlighted||o.feed.isIgnored?"placeholder":o.feed.getVideoEnabled()?o.feed.isPublisher?"video":o.feed.getVideoSubscription()?"video":o.feed.getPicture()?"picture":"placeholder":"placeholder"}function t(e){var t=$("canvas",e),n=t[0],i=$("video",e).first(),s=n.getContext("2d");n.width=t.width(),n.height=Math.round(.75*n.width);var r=new window.Image;r.src="assets/images/placeholder.png",r.onload=function(){s.drawImage(r,0,0,n.width,n.height)},o.picCanvas=t,o.picSource=i,o.picContext=s}function n(){var e=o.picCanvas[0],t=e.width;if(o.picSource[0].videoHeight){var n=t*o.picSource[0].videoHeight/o.picSource[0].videoWidth;e.height=n,o.picContext.drawImage(o.picSource[0],0,0,t,n),o.feed.updateLocalPic(e.toDataURL("image/jpeg",.4))}}var o=this;o.mirrored=o.feed.isPublisher&&!o.feed.isLocalScreen,o.thumbnailTag=e,o.initPics=t,o.takePic=n}return{restrict:"EA",templateUrl:"app/components/feed/jh-feed.html",scope:{feed:"=",toggleHighlightFn:"&",highlighted:"=",highlightedByUser:"="},controllerAs:"vm",bindToController:!0,controller:s,link:i}}angular.module("janusHangouts").directive("jhFeed",e),e.$inject=["RoomService","$interval","jhConfig","MuteNotifier"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){function n(e){return h[e]||null}function o(){return d}function i(n,o,i){var s=e.defer(),r=this.find(n),a=this;if(o=o||10,i=i||1e3,null===r)var l=t.setInterval(function(){r=a.find(n),null===r?o-=1:(t.clearInterval(l),s.resolve(r)),0===o&&(t.clearInterval(l),s.reject("feed with id "+n+" was not found"))},i);else s.resolve(r);return s.promise}function s(e,t){h[e.id]=e,t&&t.main&&(d=e)}function r(e){delete h[e],d&&e===d.id&&(d=null)}function a(){return _.values(h)}function l(){return _.filter(this.allFeeds(),function(e){return e.isPublisher})}function c(){return _.filter(this.allFeeds(),function(e){return e.isLocalScreen})}function u(){return _.detect(this.allFeeds(),function(e){return e.getSpeaking()})}var d=null,h={};this.find=n,this.findMain=o,this.add=s,this.destroy=r,this.allFeeds=a,this.publisherFeeds=l,this.localScreenFeeds=c,this.speakingFeed=u,this.waitFor=i}angular.module("janusHangouts").service("FeedsService",e),e.$inject=["$q","$window"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o){return function(i){function s(n){e(function(){a.isEnabled("audio")===!1&&(n=!1),c!==n&&(c=n,n===!1&&(u=Date.now()),t.sendStatus(a,{exclude:"picture"}))})}function r(e){if(null===g||void 0===g)return null;var t="get"+_.capitalize(e)+"Tracks";if(null===g[t]()||void 0===g[t]())return null;var n=g[t]()[0];return void 0===n?null:n}i=i||{};var a=this;this.id=i.id||0,this.display=i.display||null,this.isPublisher=i.isPublisher||!1,this.isLocalScreen=i.isLocalScreen||!1,this.isIgnored=i.ignored||!1,this.connection=i.connection||null;var l=null,c=!1,u=Date.now(),d=!0,h=!0,g=null,f=null;this.isEnabled=function(e){return this.isPublisher?this.connection&&this.connection.getConfig()?this.connection.getConfig()[e]:null:"audio"===e?h:d},this.isTrackEnabled=function(e){var t=r(e);return null!==t&&t.enabled},this.setEnabledTrack=function(e,t){var n=r(e);null!==n&&(n.enabled=t)},this.hasTrack=function(e){return null!==r(e)},this.setPicture=function(e){l=e},this.getPicture=function(){return l},this.setStream=function(e){this.isPublisher&&!this.isLocalScreen&&(f=new n(e,{start:function(){s(!0)},stop:function(){s(!1)}})),g=e},this.getStream=function(){return g},this.setSpeaking=function(e){c=e},this.getSpeaking=function(){return c},this.setAudioEnabled=function(e){h=e},this.getAudioEnabled=function(){return this.isEnabled("audio")},this.setVideoEnabled=function(e){d=e},this.getVideoEnabled=function(){return this.isEnabled("video")},this.isVoiceDetected=function(){return f&&f.isSpeaking()},this.isDataOpen=function(){return this.connection?this.connection.isDataOpen:!1},this.isConnected=function(){return null!==this.connection},this.disconnect=function(){this.connection&&this.connection.destroy(),f&&f.destroy(),this.connection=null},this.ignore=function(){this.isIgnored=!0,this.disconnect()},this.stopIgnoring=function(e){this.isIgnored=!1,this.connection=e},this.waitingForConnection=function(){return this.isIgnored===!1&&!this.connection},this.setEnabledChannel=function(n,i,s){var r=this;if(s=s||{},this.isPublisher){var a={};a[n]=i,this.connection.setConfig({values:a,ok:function(){e(function(){"audio"===n&&i===!1&&(c=!1),s.after&&s.after(),t.sendStatus(r,{exclude:"picture"}),o.emitEvent({type:"channel",data:{channel:n,status:i,peerconnection:r.connection.pluginHandle.webrtcStuff.pc}})})}}),"video"===n&&this.setEnabledTrack("video",i)}else"audio"===n&&i===!1&&t.sendMuteRequest(this)},this.updateLocalPic=function(n){var o=this;e(function(){l=n,t.sendStatus(o)})},this.updateDisplay=function(n){var o=this;e(function(){o.setDisplay(n),t.sendStatus(o)})},this.getDisplay=function(){return this.display},this.setDisplay=function(e){this.display=e},this.getStatus=function(e){e=e||{},e.exclude||(e.exclude=[]);var t=["audioEnabled","videoEnabled","speaking","picture","display"],n={};return _.forEach(t,function(t){_.includes(e.exclude,t)||(n[t]=a["get"+_.capitalize(t)]())}),n},this.setStatus=function(t){var n=this;e(function(){c===!0&&t.speaking===!1&&(u=Date.now()),_.forEach(t,function(e,t){n["set"+_.capitalize(t)](e)})})},this.isSilent=function(e){return e||(e=6e3),!c&&u<Date.now()-e},this.setVideoSubscription=function(e){this.connection.setConfig({values:{video:e}})},this.getVideoSubscription=function(){return this.connection&&this.connection.getConfig()?this.connection.getConfig().video:null}}}angular.module("janusHangouts").factory("Feed",e),e.$inject=["$timeout","DataChannelService","SpeakObserver","EventsService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){return function(n,o,i){var s=this;this.pluginHandle=n,this.role=i||"subscriber",this.isDataOpen=!1,this.config=null,console.log(this.role+" plugin attached ("+n.getPlugin()+", id="+n.getId()+")"),this.destroy=function(){t.emitEvent({type:"pluginHandle",data:{status:"detached","for":s.role,pluginHandle:s.pluginHandle}}),this.config=null,this.pluginHandle.detach()},this.register=function(e,t){var i={request:"join",room:o,ptype:"publisher",display:e,pin:t||""};n.send({message:i})},this.listen=function(e,t){var i={request:"join",room:o,ptype:"listener",feed:e,pin:t||""};n.send({message:i})},this.handleRemoteJsep=function(e){n.handleRemoteJsep({jsep:e})},this.sendData=function(e){n.data(e)},this.publish=function(o){o=o||{};var i={videoRecv:!1,audioRecv:!1},r={video:!0,audio:!0};"main"===this.role?(o.muted&&(r.audio=!1),o.noCamera?(i.videoSend=!1,r.video=!1):i.videoSend=!0,i.audioSend=!0,i.data=!0,r.data=!0):(r.audio=!1,r.data=!1,i.video=this.role,i.audioSend=!1,i.data=!1),n.createOffer({media:i,success:function(t){console.log("Got publisher SDP!"),console.log(t),s.config=new e(n,r,t),o.success&&o.success()},error:function(e){console.error("WebRTC error publishing"),console.error(e),t.emitEvent({type:"error",data:{status:"createOffer",error:e,peerconnection:s.pluginHandle.webrtcStuff.pc}}),o.error&&o.error()}})},this.subscribe=function(e){n.createAnswer({jsep:e,media:{audioSend:!1,videoSend:!1,data:!0},success:function(e){console.log("Got SDP!"),console.log(e);var t={request:"start",room:o};n.send({message:t,jsep:e})},error:function(e){console.error("WebRTC error subscribing"),console.error(e),t.emitEvent({type:"error",data:{status:"createAnswer",error:e,peerconnection:s.pluginHandle.webrtcStuff.pc}})}})},this.setConfig=function(t){this.config?this.config.set(t):this.config=new e(n,t.values,null,t.ok)},this.getConfig=function(){return this.config?this.config.get():void 0},this.confirmConfig=function(){return this.config?this.config.confirm():void 0},this.onDataOpen=function(){this.isDataOpen=!0}}}angular.module("janusHangouts").factory("FeedConnection",e),e.$inject=["ConnectionConfig","EventsService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){return function(t,n,o,i){function s(e){return e.video!==c.video||e.audio!==c.audio}function r(e){e=e||{};var n={request:"configure"};l={},_.assign(l,a,c),_.assign(n,l),t.send({message:n,jsep:e.jsep,success:function(){u=e.ok},error:function(){l=null,console.error("Config request not sent")}})}var a={},l=null,c={audio:!0,video:!0,data:!0},u=null;_.assign(c,n),r({jsep:o,ok:i}),this.get=function(){return a},this.set=function(e){e=e||{},e.values=e.values||{};var t={};_.assign(t,a,c),_.assign(c,a,e.values),null===l&&s(t)&&r({ok:e.ok})},this.confirm=function(){e(function(){null===l?console.error("I haven't sent a config. Where does this confirmation come from?"):(a=l,l=null,console.log("Connection configured",a),u&&u(),s(a)&&r())})}}}angular.module("janusHangouts").factory("ConnectionConfig",e),e.$inject=["$timeout"]}(),angular.module("janusHangouts").directive("autoFocus",["$timeout",function(e){return{restrict:"A",link:function(t,n,o){t.$eval(o.autoFocus)!==!1&&e(function(){t.$emit("focus",n[0]),n[0].focus()})}}}]),/**
 * @file      events.service.js
 * @author    Bimalkant Lauhny <lauhny.bimalk@gmail.com>
 * @copyright MIT License
 * @brief     Creates an event emitter using a subject observable
 *            to which different services can subscribe
 */
function(){function e(){var e=null,t=null,n=null;this.init=function(){n=new window.Rx.Subject,(null===n||void 0===n)&&console.error("Could not load rx.js! Event emitter will not work.")},this.setUser=function(t){e=t},this.setRoom=function(e){t=e},this.getEventsSubject=function(){return n},this.emitEvent=function(o){o.user=e,o.room=t,o.timestamp=Date.now(),null===n||void 0===n?console.log("Event emitter is not configured. Event not emitted"):n.onNext(o)}}angular.module("janusHangouts").service("EventsService",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){function e(){var e=this;e.text=e.message.text()}return{restrict:"EA",templateUrl:"app/components/chat/jh-log-entry.html",scope:{message:"="},controllerAs:"vm",bindToController:!0,controller:e}}angular.module("janusHangouts").directive("jhLogEntry",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){function e(e){e.$watch("vm.messages.length",function(e){if(void 0!==e){var t=document.getElementById("jh-chat-messages");setTimeout(function(){t&&(t.scrollTop=t.scrollHeight)},100)}})}function t(){}return{restrict:"EA",templateUrl:"app/components/chat/jh-chat.html",scope:{messages:"="},link:e,controllerAs:"vm",bindToController:!0,controller:t}}angular.module("janusHangouts").directive("jhChat",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){function e(){var e=this;e.embedOptions={link:!0,linkTarget:"_blank",sanitizeHtml:!1,image:{embed:!0},pdf:{embed:!1},audio:{embed:!0},code:{highlight:!1},basicVideo:!0,tweetEmbed:!1}}return{restrict:"EA",templateUrl:"app/components/chat/jh-chat-message.html",scope:{message:"="},controllerAs:"vm",bindToController:!0,controller:e}}angular.module("janusHangouts").directive("jhChatMessage",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(){function t(){e.writeChatMessage(n.text),n.text=null}var n=this;n.text=null,n.submit=t}return{restrict:"EA",templateUrl:"app/components/chat/jh-chat-form.html",scope:{message:"="},controllerAs:"vm",bindToController:!0,controller:t}}angular.module("janusHangouts").directive("jhChatForm",e),e.$inject=["ActionService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e){function t(){function t(){e.open({animation:!0,templateUrl:"app/components/browser-info/browser-info.html",controller:"BrowserInfoCtrl",controllerAs:"vm"})}var n=this;n.showHelp=t}return{restrict:"EA",templateUrl:"app/components/browser-info/jh-browser-info.html",scope:!0,controllerAs:"vm",bindToController:!0,controller:t}}angular.module("janusHangouts").directive("jhBrowserInfo",e),e.$inject=["$uibModal"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t){function n(){e.dismiss("cancel")}var o=this;o.usingSSL=function(){return t.usingSSL()},o.httpsUrl=function(){return t.httpsUrl()},o.close=n}angular.module("janusHangouts").controller("BrowserInfoCtrl",e),e.$inject=["$uibModalInstance","RequestService"]}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(){}angular.module("janusHangouts").controller("SigninController",e)}(),/*
 * Copyright (C) 2015 SUSE Linux
 *
 * This software may be modified and distributed under the terms
 * of the MIT license.  See the LICENSE.txt file for details.
 */
function(){function e(e,t,n,o,i,s){var r=i.getRoom(),a=o.getUser(),l={};null===r||null===a?(null!==r&&(l.room=r.id),t.go("signin",l)):void 0===t.params.user?(l.room=r.id,l.user=a.username,t.go(t.current.name,l,{location:"replace"})):i.enter(a.username),e.$on("room.error",function(e,n){"Unauthorized (wrong pin)"===n?t.go("signin",l):alert("Janus server reported the following error:\n"+n)}),e.$on("consentDialog.changed",function(e,t){t?n.start():t||n.stop()}),s.bindTo(e).add({combo:"alt+m",description:"Mute or unmute your microphone",callback:function(){i.toggleChannel("audio")}}).add({combo:"alt+n",description:"Disable or enable camera",callback:function(){i.toggleChannel("video")}}).add({combo:"alt+q",description:"Sign out",callback:function(){o.signout()}}),e.hotkeys=s}angular.module("janusHangouts").controller("RoomCtrl",e),e.$inject=["$scope","$state","blockUI","UserService","RoomService","hotkeys"]}(),function(){angular.module("janusHangouts.config",[]).provider("jhConfig",function(){var e={janusServer:null,janusServerSSL:null,janusDebug:!1,httpsAvailable:!0,httpsUrl:null,videoThumbnails:!0,joinUnmutedLimit:3};return{$get:function(){return e},$set:function(t,n){e[t]=n}}})}(),angular.module("janusHangouts").run(["$templateCache",function(e){e.put("app/room/consent-dialog.html",'<img src="assets/images/up_arrow.png">'),e.put("app/room/room.html",'<div class="row" id="main-chat-session"><div jh-video-chat="true"></div></div>'),e.put("app/signin/signin.html",'<div id="signin"><jh-signin-form></jh-signin-form></div>'),e.put("app/templates/global-notification.html",'<style>\n  #global-notifications{position:fixed;z-index:1030;top:51px;left:0;text-align:center;background-color:#cfe1e9;color:#212121;width:100%;}\n  .global-notification{padding: 4px 10px;}\n  .global-notification .icon{margin-right:5px !important}\n  .global-notification .close-button{color:#777;margin-left:10px !important;cursor:pointer}\n  .global-notification .close-button:hover{color:#3b3b3b}\n  .global-notification.notification-warning{background-color:#ffe479}\n  .global-notification.notification-info{background-color:#9dd3eb}\n  .global-notification.notification-success{background-color:#C5ED73}\n  .global-notification.notification-error{background-color:#d9534f;color:#fff;}\n  .global-notification.notification-error .close-button{color:#fff}\n  .global-notification.notification-error .close-button:hover{color:#ff9898}\n</style><div class="global-notification notification-{{data.type}}"><i ng-class="data.faIcon" ng-if="data.faIcon" class="fa fa-fw icon"></i> <strong ng-if="data.title">{{data.title}}:&nbsp;</strong><span ng-click="close()" ng-if="data.closeButton" class="close-button pull-right">✖</span> <span>{{data.message}}</span> <a ng-repeat="action in data.actions" ng-click="action.fn()" ng-class="action.className">{{action.label}}</a></div>'),e.put("app/templates/gmail-notification.html",'<div class="gmail-template"><style scoped="">\n    .gmail-template {\n      position: relative;\n      right: 0;\n      left: 0;\n      margin: 4px 0;\n      text-align: center;\n    }\n    .gmail-template div {\n      position: relative;\n      display: inline-block;\n      margin: 0 auto;\n\n      border:1px solid rgb(240, 195, 109);\n      background-color: rgb(249, 237, 190);\n      font-size: 13px;\n      font-weight: bold;\n      padding:2px 8px 2px 8px;\n\n      -webkit-transition: opacity 0.5s ease-out 4s;\n      -moz-transition: opacity 0.5s ease-out 4s;\n      -o-transition: opacity 0.5s ease-out 4s;\n      transition: opacity 0.5s ease-out 4s;\n    }\n    .gmail-template .gmail-template-error {\n      background-color: #DD8181;\n      border: 1px solid #D54B4B;\n    }\n    .gmail-template-close {\n      color: #9E9E9E;\n    }\n    .gmail-template-close:hover {\n      color: #505050;\n    }\n    .gmail-template-error .gmail-template-close {\n      color: #777777;\n    }\n    .gmail-template-error .gmail-template-close:hover {\n      color: #3B3B3B;\n    }\n    .gmail-template a {\n      cursor: pointer;\n      text-decoration: underline;\n    }\n  </style><div ng-class="\'gmail-template-\' + data.type"><i class="fa fa-fw" ng-class="data.faIcon" ng-if="data.faIcon"></i> {{data.title}}: {{data.message}} <a ng-repeat="action in data.actions" ng-click="action.fn()" ng-class="action.className">{{action.label}}</a> <i class="fa fa-fw fa-times gmail-template-close" ng-click="close()" ng-if="data.faIcon && data.closeButton"></i> <span class="gmail-template-close" ng-click="close()" ng-if="!data.faIcon && data.closeButton">✖</span></div></div>'),e.put("app/components/browser-info/browser-info.html",'<div class="modal-header"><button type="button" class="close" ng-click="vm.close()" aria-label="Close"><span aria-hidden="true">&times;</span></button><h3 class="modal-title">Information about browsers</h3></div><div class="modal-body"><h4>Firefox</h4><p>At least Firefox 36 is required, a more recent version is recommended.</p><p>Firefox will refuse to use any bit rate lower than a certain limit (200 kbps by default). In some situations, a lower bit rate can be useful to save bandwidth and processing power in the clients. This limit can be adjusted (a sensible value would be 64) modifying the <code>media.peerconnection.video.min_bitrate</code> setting at <a href="about:config">about:config</a>.</p><h4>Chrom(e/ium)</h4><p>Jangouts has been successfully tested with Chromium 41. It will probably work with older versions as well, but the usage of a version as recent as possible is recommended (see exception below).</p><p>There is a known bug in Chromium 46 (and maybe other versions of both Chrome and Chromium) that causes it to crash during initialization of WebRTC connections when running in sandbox mode (which is the default). If Chrom(e/ium) crashes when entering a Jangouts room, close it and execute it again adding the <code>--no-sandbox</code> parameter to the command line.</p><p>Chrome and Chromium 47 (and probably more recent versions) seem to refuse to send WebRTC content (neither audio or video) over plain HTTP. <span ng-if="vm.usingSSL()">You should not be affected by that problem, since you are using a SSL (HTTPS) connection.</span> <span ng-if="!vm.usingSSL() && vm.httpsUrl()">To avoid this and other problems, it\'s probably a good idea to access the <a class="alert-link" ng-href="{{vm.httpsUrl()}}">SSL (HTTPS) version</a> of this site.</span></p></div><div class="modal-footer"><button class="btn btn-primary" ng-click="vm.close()">OK</button></div>'),e.put("app/components/browser-info/jh-browser-info.html",'<small><i class="fa fa-info-circle"></i> Tested with recent versions of Firefox, Chrome and Chromium. Please review the <a class="alert-link" href="#" ng-click="vm.showHelp()">detailed information</a> about browsers before proceeding.</small>'),e.put("app/components/chat/jh-chat-form.html",'<form name="chatMessage" ng-submit="vm.submit()"><div class="input-group"><input class="form-control input-sm" placeholder="Type your message here..." type="text" ng-model="vm.text" required=""> <span class="input-group-btn"><button class="btn btn-sm" ng-disabled="chatMessage.$invalid">Send</button></span></div></form>'),e.put("app/components/chat/jh-chat-message.html",'<div class="header"><strong>{{ vm.message.content.feed.display }}</strong> <small class="pull-right text-muted"><span class="glyphicon glyphicon-time"></span> {{ vm.message.timestamp | date:\'shortTime\' }}</small></div><ng-embed embed-data="vm.message.text()" embed-options="vm.embedOptions"></ng-embed>'),e.put("app/components/chat/jh-chat.html",'<div class="jh-chat panel panel-default"><div class="panel-body" id="jh-chat-messages"><ul><li ng-repeat="m in vm.messages"><jh-chat-message message="m" ng-if="m.type === \'chatMsg\'"></jh-chat-message><jh-log-entry message="m" ng-if="m.type !== \'chatMsg\'"></jh-log-entry></li></ul></div><div class="panel-footer" id="chat-form-footer"><jh-chat-form></jh-chat-form></div></div>'),e.put("app/components/chat/jh-log-entry.html",'<span class="log-entry">{{ vm.text }}</span>'),e.put("app/components/feed/jh-feed.html",'<figure ng-class="{\'own-feed\': vm.feed.isPublisher, sticky: vm.highlightedByUser}"><div class="thumb" ng-click="vm.toggleHighlightFn()"><video autoplay="" class="face" ng-class="{mirrored: vm.mirrored}" poster="assets/images/placeholder.png" ng-show="vm.thumbnailTag() === \'video\'"></video><img ng-src="{{vm.feed.getPicture()}}" class="face" ng-class="{mirrored: vm.mirrored}" ng-show="vm.thumbnailTag() === \'picture\'"> <img ng-src="assets/images/placeholder.png" class="face" ng-class="{mirrored: vm.mirrored}" ng-show="vm.thumbnailTag() === \'placeholder\'"><canvas ng-show="false"></canvas></div><figcaption ng-init="buttons=false"><span class="caption" ng-class="{dropdown: buttons, dropup: !buttons}" ng-click="buttons=!buttons"><span class="caret"></span> {{ vm.feed.display }}</span><div class="buttons"><jh-unpublish-button feed="vm.feed"></jh-unpublish-button><jh-audio-button feed="vm.feed" with-monitor="true"></jh-audio-button></div><div class="additional-buttons" ng-show="buttons"><jh-sticky-button feed="vm.feed" click-fn="buttons=false; vm.toggleHighlightFn()" highlighted="vm.highlighted" sticky="vm.highlightedByUser"></jh-sticky-button><jh-video-button feed="vm.feed" ng-click="buttons=false"></jh-video-button><jh-ignore-button feed="vm.feed" ng-click="buttons=false"></jh-ignore-button><jh-ignore-audio-button feed="vm.feed" ng-click="buttons=false"></jh-ignore-audio-button></div></figcaption></figure>'),e.put("app/components/feed/jh-main-feed-info.html",'<span><div class="name-edit" ng-show="vm.isEditing()"><input ng-if="vm.isEditing()" ng-keydown="vm.keyDetect($event)" ng-blur="vm.leaveEditingMode()" ng-model="vm.newName" placeholder="new name" auto-focus=""> <span class="glyphicon glyphicon-question-sign" title="Press Enter to change&#013; Press Escape to keep"></span></div><span class="feed-info" title="Click to Edit Name" ng-click="vm.makeNameEditable()" ng-hide="vm.isEditing()">{{ vm.name() }}</span></span>'),e.put("app/components/feed/jh-main-feed.html",'<video autoplay=""></video>'),e.put("app/components/room/jh-leave-button.html",'<button class="btn" ng-click="vm.leave()" title="Sign out"><span class="glyphicon glyphicon-log-out" aria-hidden="true"></span></button>'),e.put("app/components/room/jh-room-info.html",'<span class="room-info">{{ vm.name() }}</span>'),e.put("app/components/screen-share/jh-screen-share-button-moz.html","<jh-screen-share-sub-button source=\"'window'\" icon=\"'modal-window'\" label=\"'Share a window'\"></jh-screen-share-sub-button><jh-screen-share-sub-button source=\"'screen'\" icon=\"'blackboard'\" label=\"'Share the desktop'\"></jh-screen-share-sub-button>"),e.put("app/components/screen-share/jh-screen-share-button.html","<jh-screen-share-sub-button source=\"'screen'\" icon=\"'blackboard'\" label=\"'Share a window/desktop'\"></jh-screen-share-sub-button>"),e.put("app/components/screen-share/jh-screen-share-hint.html",'<small ng-if="vm.visible()"><span ng-if="vm.usingSSL()">If you wish to use the screen sharing functionality, make sure you have understood <a class="alert-link" href="#" ng-click="vm.showHelp()">these instructions</a>.</span> <span ng-if="!vm.usingSSL()">Screen sharing will not work without SSL. If you want to make use of that functionality, access the <a class="alert-link" ng-href="{{vm.httpsUrl()}}">HTTPS version</a> of this site.</span></small>'),e.put("app/components/screen-share/jh-screen-share-sub-button.html",'<div style="display: inline-block;" uib-tooltip="{{vm.title()}}" tooltip-placement="bottom"><button class="btn" ng-disabled="!vm.enabled()" ng-click="vm.click()"><span class="glyphicon glyphicon-{{vm.icon}}" aria-hidden="true"></span></button></div>'),e.put("app/components/screen-share/screen-share-help.html",'<div class="modal-header"><button type="button" class="close" ng-click="vm.close()" aria-label="Close"><span aria-hidden="true">&times;</span></button><h3 class="modal-title">Screen sharing</h3></div><div class="modal-body"><p>Sharing your screen is an experimental feature in WebRTC and only works if the browser you\'re using meets particular requirements.</p><p>Active screen/window sharing will only work from Firefox if you have at least version 33 installed. In addition, two adjustments must be done in the settings at <a href="about:config">about:config</a>. First, make sure <code>media.getusermedia.screensharing.enabled</code> is enabled. Then, make sure <code>{{ vm.hostname() }}</code> is listed in <code>media.getusermedia.screensharing.allowed_domains</code>.</p><p>If you\'re using a recent version of Chrome (34+), you\'ll need to install <a href="https://chrome.google.com/webstore/detail/janus-webrtc-screensharin/hapfgfdkleiggjjpfpenajgdnfckjpaj">this extension</a>. If you\'re using an older verson of Chrome, instead, you\'ll need to manually enable the Chrome flag <a href="chrome://flags/#enable-usermedia-screen-capture">chrome://flags/#enable-usermedia-screen-capture</a>. Otherwise you\'ll get a permission error. Moreover, please beware that some versions of Chrome may only support the feature if you explicitly pass the <code>--enable-usermedia-screen-capturing</code> parameter on the command line.</p></div><div class="modal-footer"><button class="btn btn-primary" ng-click="vm.close()">OK</button></div>'),e.put("app/components/user/jh-signin-form.html",'<div class="form-signin"><div class="text-center"><img src="images/jangouts-logo.png" class="jangouts-logo-login"></div><form ng-submit="vm.signin()"><div class="form-group"><label class="sr-only" for="inputUsername">Username</label> <input id="inputUsername" class="form-control input-lg" type="text" ng-model="vm.username" required="true" placeholder="Username"></div><div class="form-group"><label class="sr-only" for="inputRoom">Room</label> <span ng-if="vm.showRoom()">{{ vm.room.label }}</span><select ng-if="vm.showRoomsList()" id="inputRoom" class="form-control input-lg" ng-model="vm.room" required="true" ng-options="room.label for room in vm.rooms track by room.id"><option value="" disabled="" selected="">Select a room</option></select></div><div ng-show="vm.room.pin_required" class="form-group"><label class="sr-only" for="inputPin">Pin</label> <span>Please enter the right Pin to access this Room!</span> <input id="inputPin" class="form-control input-lg" type="password" ng-model="vm.enteredPin" placeholder="Pin (required)"></div><jh-thumbnails-mode-button text-template="true"></jh-thumbnails-mode-button><button id="signInButton" class="btn btn-lg btn-primary btn-block" type="submit">Sign in</button></form><div class="login-msg"><jh-browser-info></jh-browser-info><hr><jh-screen-share-hint></jh-screen-share-hint></div></div>'),e.put("app/components/videochat/jh-video-chat.html",'<div class="row"><header><div class="row"><div class="col-xs-6 col-sm-5"><jh-room-info></jh-room-info><button class="btn" ng-click="vm.showHotkeys()" title="Keyboard shortcuts"><span class="glyphicon glyphicon-info-sign" aria-hidden="true"></span></button><jh-thumbnails-mode-button></jh-thumbnails-mode-button><jh-resize-mode-button toggle-fn="vm.toggleWindowResizeMode()" reset-fn="vm.setDefaultLayout()" resize-mode-on="vm.windowResizeModeOn"></jh-resize-mode-button><jh-leave-button></jh-leave-button></div><div class="hidden-xs col-sm-2 text-center"><img src="images/jangouts-logo.png" id="logo"></div><div class="col-xs-6 col-sm-5 text-right"><jh-main-feed-info></jh-main-feed-info><jh-screen-share-button></jh-screen-share-button><jh-video-button feed="vm.mainFeed()"></jh-video-button><jh-pushtotalk-button></jh-pushtotalk-button><jh-audio-button feed="vm.mainFeed()"></jh-audio-button></div></div></header></div><div class="row" id="videochat-body"><div gridster="vm.gridsterOpts" id="videochat-playroom"><ul><li gridster-item="" row="item.position[0]" col="item.position[1]" size-x="item.size[0]" size-y="item.size[1]" ng-repeat="item in vm.gridsterItems"><div ng-if="item.content === \'Speaker\'" class="grid-item-content" id="main-video" jh-main-feed="true" feed="vm.highlightedFeed()" ng-class="{mirrored: vm.mirrored()}"></div><div ng-if="item.content === \'Participants\'" class="grid-item-content" id="thumbnails"><div jh-feed="true" feed="f" ng-repeat="f in vm.feeds() | orderBy:\'+display\'" toggle-highlight-fn="vm.toggleHighlightedFeed(f)" highlighted="vm.isHighlighted(f)" highlighted-by-user="vm.isHighlightedByUser(f)"></div></div><div ng-if="item.content === \'Chat\'" class="grid-item-content"><jh-chat messages="vm.logEntries()"></jh-chat></div></li></ul></div></div>'),e.put("app/components/feed/buttons/jh-audio-button.html",'<button type="button" class="btn" ng-class="{\'btn-primary\': vm.isSpeaking(), \'btn-default\': !vm.isSpeaking()}" ng-click="vm.toggle()" title="Disable audio" ng-show="vm.showsDisable()"><span class="glyphicon glyphicon-volume-up"></span></button><button type="button" class="btn btn-danger" ng-click="vm.toggle()" title="Enable audio" ng-show="vm.showsEnable()"><span class="glyphicon glyphicon-volume-off"></span></button><button type="button" disabled="" class="btn btn-danger" title="Audio disabled" ng-show="vm.showsAudioOff()"><span class="glyphicon glyphicon-volume-off"></span></button>'),e.put("app/components/feed/buttons/jh-ignore-audio-button.html",'<button type="button" class="btn btn-default" ng-click="vm.toggle()" title="Don\'t play audio" ng-show="vm.showsIgnore()"><span class="glyphicon glyphicon-volume-off"></span></button><button type="button" class="btn btn-danger" ng-click="vm.toggle()" title="Restore audio" ng-show="vm.showsStopIgnoring()"><span class="glyphicon glyphicon-volume-off"></span></button>'),e.put("app/components/feed/buttons/jh-ignore-button.html",'<button type="button" class="btn btn-default" ng-click="vm.ignore()" title="Ignore" ng-show="vm.showsIgnore()"><span class="glyphicon glyphicon-ban-circle"></span></button><button type="button" class="btn btn-danger" ng-click="vm.stopIgnoring()" title="Stop ignoring" ng-show="vm.showsStopIgnoring()"><span class="glyphicon glyphicon-ban-circle"></span></button>'),e.put("app/components/feed/buttons/jh-pushtotalk-button.html",'<button ng-class="{\'btn-danger\': vm.isRecording() }" class="btn push-to-talk" ng-click="vm.click($event)" title="{{vm.titleText}}"><span class="glyphicon glyphicon-bullhorn" aria-hidden="true"></span> <span ng-show="vm.showHotkey"><kbd>{{vm.hotkey}}</kbd></span> <span class="toggle-text">{{vm.toggleText}}</span></button>'),e.put("app/components/feed/buttons/jh-sticky-button.html",'<button type="button" class="btn btn-default" ng-click="vm.click()" title="Sticky as main video" ng-show="vm.showsEnable()"><span class="glyphicon glyphicon-pushpin"></span></button><button type="button" class="btn btn-danger" ng-click="vm.click()" title="Unstick" ng-show="vm.showsDisable()"><span class="glyphicon glyphicon-pushpin"></span></button>'),e.put("app/components/feed/buttons/jh-unpublish-button.html",'<button type="button" class="btn btn-default" ng-click="vm.click()" title="Stop sharing" ng-show="vm.isVisible()"><span class="glyphicon glyphicon-remove"></span></button>'),e.put("app/components/feed/buttons/jh-video-button.html",'<button type="button" class="btn btn-default" ng-click="vm.toggle()" title="Disable video" ng-show="vm.showsDisable()"><span class="glyphicon glyphicon-eye-open"></span></button><button type="button" class="btn btn-danger" ng-click="vm.toggle()" title="Enable video" ng-show="vm.showsEnable()"><span class="glyphicon glyphicon-eye-close"></span></button>'),e.put("app/components/videochat/buttons/jh-resize-mode-button.html",'<button ng-show="vm.showsReset()" class="btn" ng-click="vm.reset()" title="Reset layout to default"><span class="glyphicon glyphicon-trash" aria-hidden="true"></span></button> <button ng-class="{ \'btn-danger\': vm.resizeModeOn }" class="btn" ng-click="vm.toggle()" title="Window resize mode"><span class="glyphicon glyphicon-pushpin" aria-hidden="true"></span></button>'),e.put("app/components/videochat/buttons/jh-thumbnails-mode-button-with-text.html",'<div class="checkbox" uib-tooltip="Disable to lower bandwidth and CPU usage" tooltip-placement="bottom"><label><input type="checkbox" ng-checked="vm.isChecked()" ng-click="vm.click()">Video thumbnails</label></div>'),e.put("app/components/videochat/buttons/jh-thumbnails-mode-button.html",'<button ng-class="{ \'btn-danger\': !vm.isChecked() }" class="btn" ng-click="vm.click()" title="Toggle Picture/Video thumbnails. Use picture mode to lower bandwidth and CPU usage"><span class="glyphicon" ng-class="{ \'glyphicon-picture\': !vm.isChecked(), \'glyphicon-facetime-video\': vm.isChecked() }" aria-hidden="true"></span></button>'),e.put("app/components/footer/jh-footer.html",'<footer class="footer"><div class="container-fluid"><span class="pull-left">&copy; <a href="http://www.suse.com/" target="_blank">SUSE 2015</a></span><span class="pull-right">Version 0.4.7</span><div class="clearfix"></div></div></footer>')}]);